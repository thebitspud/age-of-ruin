let addHeader=function(e){return`<p class="header">${e}</p><hr class="header">`},addButton=function(e,t){return`<button class="option" onclick="${e}">${t}</button>`},addIDButton=function(e,t,n){return`<button id="${e}" class="option" onclick="${t}">${n}</button>`};function setOptions(e){$("#options").empty().append(e)}$(function(){displayPlayer(),displayInventory(),$("#history").append(addHeader("HISTORY")),$("#inspect").append(addHeader("INSPECT")),playEvent("intro-1")});const items={berries:{type:"consumable",name:"Berries",weight:2,desc:"A fistful of edible berries that can be eaten to restore some health.",effect:"+7 HP over 15s"},"blunt-dagger":{type:"weapon",name:"Blunt Dagger",weight:3,desc:"A worn but functional dagger with a dull blade. It would be more useful if sharpened.",atk_dmg:6,atk_rate:1,size:"secondary"},error:{type:"debug",name:"Missing Item",weight:0,desc:"That item could not be accessed. Please report this issue to <a href='https://github.com/thebitspud/age-of-ruin/issues' target='_blank' rel='noopener'>the developer</a>."},"heal-salve":{type:"consumable",name:"Healing Salve",weight:2,desc:"A potent herbal blend that can disinfect and heal lesser wound.",effect:"+15 HP over 10s"},"small-pack":{type:"equipable",name:"Small Backpack",weight:8,desc:"A small pack that can be worn to increase your inventory weight cap.",section:"Back"},"tali-life":{type:"accessory",name:"Talisman of Life",weight:3,desc:"A golden artifact covered with strange inscriptions. When held, it radiates a pleasant energy.",effect:"+1 HP every 3s"}};let inventory=[],itemLink=function(e){return`<button style="color: green" onClick="inspectItem('${e}')">${items[e].name}</button>`};function displayInventory(){let e=$("#inventory");e.empty().append(addHeader("INVENTORY"));let t=0,n=!1;for(let a in inventory)e.append(`${itemLink(inventory[a])}<br>`),"small-pack"===inventory[a]&&(n=!0),t+=items[inventory[a]].weight;n&&(player.weight.max=100),player.weight.now=t,displayPlayer()}function acquireItem(e){itemObj=items[e],itemObj.weight+player.weight.now>player.weight.max||("None"===player.primary&&"weapon"===itemObj.type&&(player.primary=e),inventory.push(e),$("#info").append(`Acquired ${itemLink(e)}<br><br>`),displayInventory())}function inspectItem(e){let t=items.error;for(let n=0;n<Object.keys(items).length;n++)if(Object.keys(items)[n]===e){t=Object.values(items)[n];break}switch($inspect=$("#inspect"),$inspect.empty().append(addHeader("INSPECT")).append(`<p style="color: green; text-align: center">${t.name}</p>`).append(`<br>${t.desc}`).append(`<br><br>Weight: ${t.weight}`),t.type){case"weapon":$inspect.append(`<br>Attack Damage: ${t.atk_dmg}`),$inspect.append(`<br>Attack Cooldown: ${t.atk_rate.toFixed(1)}s`);break;case"consumable":case"accessory":$inspect.append(`<br>Effect: ${t.effect}`);break;case"equipable":$inspect.append(`<br>Section: ${t.section}`)}}const player={health:{max:100,now:100},energy:{max:100,now:100},weight:{max:25,now:0},def:0,primary:"None",secondary:"None"};function displayPlayer(){$player=$("#player"),$player.empty().append(addHeader("PLAYER")).append(`Health : ${player.health.now} / ${player.health.max}`).append(`<br>Energy : ${player.energy.now} / ${player.energy.max}`).append(`<br>Weight : ${player.weight.now} / ${player.weight.max}`),"None"===player.primary?$player.append("<br><br>Primary : None"):$player.append(`<br><br>Primary : ${itemLink(player.primary)}`),"None"===player.secondary?$player.append("<br>Secondary : None"):$player.append(`<br>Secondary : ${itemLink(player.secondary)}`)}const enemies={"giant-raven":{name:"Giant Raven",health:30,atk_dmg:2,atk_rate:2,def:1,desc:"A large, mean looking bird."},error:{health:0,atk_dmg:0,atk_rate:0,def:0,desc:'That enemy could not be found. Please report this issue to <a href="https://github.com/thebitspud/age-of-ruin/issues" target="_blank" rel="noopener">the developer</a>.'}};let activeEnemy={name:"",health:0},nextEvent="",enemyLink=function(e){return`<button style="color: brown" onClick="inspectEnemy('${e}')">${enemies[e].name}</button>`};function inspectEnemy(e){let t=enemies.error;for(let n=0;n<Object.keys(enemies).length;n++)if(Object.keys(enemies)[n]===e){t=Object.values(enemies)[n];break}$inspect=$("#inspect"),$inspect.empty().append(addHeader("INSPECT")).append(`<p style="color: brown; text-align: center">${t.name}</p>`).append(`<br>${t.desc}`).append(`<br><br>Max Health: ${t.health}`).append(`<br>Attack Damage: ${t.atk_dmg}`).append(`<br>Attack Cooldown: ${t.atk_rate.toFixed(1)}s`).append(`<br>Defense: ${t.def}`)}let enemyAttackTimer,encounterEnemy=function(e,t){return nextEvent=e,activeEnemy.name=t,activeEnemy.health=enemies[t].health,addButton("enemyPrompt()","Continue")};function enemyPrompt(){$("#info").append(`Encountered ${enemyLink(activeEnemy.name)}<br><br>`),setOptions(addButton("beginCombat()","Fight")+addButton("playerFlee()","Flee"))}function combatWin(){activeEnemy.health=0,clearInterval(enemyAttackTimer),$("#info").append(`${enemyLink(activeEnemy.name)} has been defeated in combat.<br><br>`),setOptions(addButton("inspectDrops()","Inspect Drops"))}function inspectDrops(){$("#info").empty().append(`${enemyLink(activeEnemy.name)} did not drop anything. <br><br>`),setOptions(addEventToggle(nextEvent,"Continue"))}function combatLoss(){clearInterval(enemyAttackTimer),$("#info").empty().append("Player has died."),$("#options").empty()}function beginCombat(){$("#info").append('Battle started!<div id="enemy"></div>'),displayEnemy(),enemyAttackTimer=setInterval(enemyAttack,1e3*enemies[activeEnemy.name].atk_rate),$options=$("#options"),$options.empty(),"None"!==player.primary&&$options.append(addIDButton("primary","playerUsePrimary()",`Use ${items[player.primary].name}`)),"None"!==player.secondary&&$options.append(addIDButton("secondary","playerUseSecondary()",`Use ${items[player.secondary].name}`)),$options.append("<br><br>"+addButton("playerSurrender()","Surrender")+addButton("playerFlee()","Flee"))}function displayEnemy(){$enemy=$("#enemy"),enemyObj=enemies[activeEnemy.name],activeEnemy.health<=0&&combatWin(),$enemy.empty(),$enemy.append(enemyLink(activeEnemy.name)+"<br><br>").append(`Health: ${activeEnemy.health} / ${enemyObj.health}`)}function playerUsePrimary(){$("#primary").attr("disabled",!0),damageDealt=items[player.primary].atk_dmg-enemies[activeEnemy.name].def,damageDealt<1&&(damageDealt=1),activeEnemy.health-=damageDealt,displayEnemy();let e=1e3*items[player.primary].atk_rate;setTimeout(function(){$("#primary").attr("disabled",!1)},e)}function playerUseSecondary(){$("#secondary").attr("disabled",!0),damageDealt=items[player.secondary].atk_dmg-enemies[activeEnemy.name].def,damageDealt<1&&(damageDealt=1),activeEnemy.health-=damageDealt,displayEnemy();let e=1e3*items[player.secondary].atk_rate;setTimeout(function(){$("#secondary").attr("disabled",!1)},e)}function playerSurrender(){clearInterval(enemyAttackTimer),$("#info").empty().append(`${enemyLink(activeEnemy.name)} lost interest and left.<br><br>`),setOptions(addEventToggle(nextEvent,"Continue"))}function playerFlee(){clearInterval(enemyAttackTimer),$("#info").empty().append(`Player successfully fled from ${enemyLink(activeEnemy.name)}.<br><br>`),setOptions(addEventToggle(nextEvent,"Continue"))}function enemyAttack(){damageDealt=enemies[activeEnemy.name].atk_dmg-player.def,damageDealt<1&&(damageDealt=1),player.health.now-=damageDealt,player.health.now<=0&&combatLoss(),displayPlayer()}function enemySurrender(){clearInterval(enemyAttackTimer)}function enemyFlee(){clearInterval(enemyAttackTimer)}let addEventToggle=function(e,t){return addButton(`playEvent('${e}')`,t)},pickUpItemPrompt=function(e,t){return addButton(`inspectItem('${t}')`,"Inspect")+addButton(`pickUpSuccess('${e}', '${t}')`,"Pick Up")+addButton(`discardItem('${e}', '${t}')`,"Discard")};const events={"intro-0":{info:"-cYou wake up and open your eyes.",options:addEventToggle("intro-1","Continue")},"intro-1":{info:"Though the ground you lie on is cold and uneven, you can't help but admire the countless stars above dotting the clear night sky.",options:addEventToggle("intro-2","Continue")},"intro-2":{info:"You sit up and look around, surveying the unfamiliar landscape.",options:addEventToggle("intro-3","Continue")},"intro-3":{info:"You can barely see the light of dawn off in the distance. It is still dark out, but you can tell that you are in an unkempt grassy field.",options:addEventToggle("intro-4","Continue")},"intro-4":{info:"You do not know where you are or how you got here.",options:addEventToggle("intro-5","Inspect Area")},"intro-5":{info:"You spot a small dagger lying on the ground.",options:addButton("inspectItem('blunt-dagger')","Inspect")+addButton("pickUpSuccess('intro-6', 'blunt-dagger')","Pick Up")},"intro-6":{info:"There appears to be nothing else of value in the region.",options:addEventToggle("intro-7","Continue")},"intro-7":{info:"Moving out of this area would be a good idea. Behind you is a towering forest, but in the opposite direction you spot what appears to be a well used road.",options:addEventToggle("forest-0","To the Forest")+addEventToggle("road-0","To the Road")},"forest-0":{info:"-cYou cautiously approach the monumental forest, peering into the dark expanse beneath the canopy.",options:addEventToggle("forest-1","Inspect Area")},"forest-1":{info:"Along the edge of the forest, you spot some bright red berries growing on a nearby shrub.",options:pickUpItemPrompt("forest-2","berries")},"forest-2":{info:"You are about to turn around and head for the road when a sudden glint of light in the undergrowth catches your eye.",options:addEventToggle("forest-3","Inspect Area")+addEventToggle("road-0","To the Road")},"forest-3":{info:"You warily advance towards the object that caught your attention. Upon further inspection, it appears to be some sort of coin-shaped talisman.",options:pickUpItemPrompt("forest-4","tali-life")},"forest-4":{info:"-cA giant shadow swoops in from above.",options:encounterEnemy("forest-5","giant-raven")},"forest-5":{info:"There appears to be nothing else of value in the region.",options:addEventToggle("road-0","To the Road")},"road-0":{info:"-cOccasional bunches of wild grasses starkly contrast the monotonous gravel of the road that surrounds them. In both directions, the winding path streches on as far as you can see.",options:addEventToggle("e-road-0","Turn Left")+addEventToggle("w-road-0","Turn Right")},"e-road-0":{info:"You turn left",options:addEventToggle("e-road-0","Turn Left")+addEventToggle("w-road-0","Turn Right")},"w-road-0":{info:"You turn right",options:addEventToggle("e-road-0","Turn Left")+addEventToggle("w-road-0","Turn Right")}};function playEvent(e){evtObj=events[e],evtInfo=evtObj.info,$info=$("#info"),evtInfo.startsWith("-c")&&($info.empty(),evtInfo=evtInfo.substr(2)),$info.append(evtInfo+"<br><br>"),setOptions(evtObj.options)}function pickUpSuccess(e,t){setOptions(addEventToggle(e,"Continue")),acquireItem(t)}function discardItem(e,t){$("#info").append(`<span style="color: red">Discarded</span> ${itemLink(t)}<br><br>`),setOptions(addEventToggle(e,"Continue"))}